[["reproducible-research.html", "Chapter 5 Reproducible research", " Chapter 5 Reproducible research # install.packages(&quot;devtools&quot;) ## if not already installed devtools::install_github(&quot;uashogeschoolutrecht/toolboxr&quot;) ## Using GitHub PAT from the git credential store. ## Skipping install of &#39;toolboxr&#39; from a github remote, the SHA1 (e43ee4ec) has not changed since last install. ## Use `force = TRUE` to force installation ## load the package library(toolboxr) library(ggplot2) library(tidyverse) ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ── ## ✔ dplyr 1.1.4 ✔ readr 2.1.5 ## ✔ forcats 1.0.0 ✔ stringr 1.5.1 ## ✔ lubridate 1.9.3 ✔ tibble 3.2.1 ## ✔ purrr 1.0.2 ✔ tidyr 1.3.1 ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ── ## ✖ dplyr::filter() masks stats::filter() ## ✖ dplyr::lag() masks stats::lag() ## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors library(nlme) ## ## Attaching package: &#39;nlme&#39; ## ## The following object is masked from &#39;package:dplyr&#39;: ## ## collapse library(ggsignif) ergo_model &lt;- lme( data = ergoStool, # the data to be used for the model fixed = effort ~ Type, # the dependent and fixed effects variables random = ~1 | Subject # random intercepts for Subject variable ) result &lt;- ergo_model %&gt;% summary() result$tTable %&gt;% as.data.frame() %&gt;% knitr::kable() Value Std.Error DF t-value p-value (Intercept) 8.5555556 0.5760123 24 14.853079 0.0000000 TypeT2 3.8888889 0.5186838 24 7.497610 0.0000001 TypeT3 2.2222222 0.5186838 24 4.284348 0.0002563 TypeT4 0.6666667 0.5186838 24 1.285305 0.2109512 # install.packages(&quot;ggsignif&quot;) ergo_model &lt;- lme( data = ergoStool, # the data to be used for the model fixed = effort ~ Type, # the dependent and fixed effects variables random = ~1 | Subject # random intercepts for Subject variable ) plot_ergo_slopes &lt;- ergoStool %&gt;% ggplot(aes(x = reorder(Type, effort), y = effort)) + geom_jitter(aes(colour = reorder(Subject, -effort)), width = 0.2, size = 3) + geom_smooth(aes(group = Subject, colour = Subject), method = &quot;lm&quot;, se = FALSE) + scale_colour_manual( values = c( &quot;red&quot;,&quot;blue&quot;, &quot;green&quot;, &quot;darkblue&quot;, &quot;darkgreen&quot;, &quot;purple&quot;, &quot;grey&quot;, &quot;black&quot;, &quot;darkgrey&quot;) ) + ylab(&quot;Effort (Borg scale score)&quot;) + xlab(&quot;Chair type&quot;) + guides(colour=guide_legend(title=&quot;Subject id&quot;)) + theme_bw() plot_ergo_slopes ## `geom_smooth()` using formula = &#39;y ~ x&#39; library(ggsignif) p_values &lt;- result$tTable %&gt;% as.data.frame() annotation_df &lt;- data.frame(Type=c(&quot;T1&quot;, &quot;T2&quot;), start=c(&quot;T1&quot;, &quot;T1&quot;), end=c(&quot;T2&quot;, &quot;T3&quot;), y=c(16, 14), label= paste(&quot;p-value:&quot;, c( formatC( p_values$`p-value`[2], digits = 3), formatC( p_values$`p-value`[3], digits = 3) ) ) ) set.seed(123) ergoStool %&gt;% ggplot(aes(x = reorder(Type, effort), y = effort)) + geom_boxplot(colour = &quot;darkgreen&quot;, outlier.shape = NA) + geom_jitter(aes( colour = reorder(Subject, -effort)), width = 0.2, size = 3) + scale_colour_manual( values = c( &quot;red&quot;, &quot;blue&quot;,&quot;green&quot;, &quot;darkblue&quot;, &quot;darkgreen&quot;, &quot;purple&quot;, &quot;grey&quot;, &quot;black&quot;, &quot;darkgrey&quot;)) + ylab(&quot;Effort (Borg scale score)&quot;) + xlab(&quot;Chair type&quot;) + guides(colour=guide_legend(title=&quot;Subject id&quot;)) + ylim(c(6,20)) + geom_signif( data=annotation_df, aes(xmin=start, xmax=end, annotations=label, y_position=y), textsize = 5, vjust = -0.2, manual=TRUE) + theme_bw() -&gt; plot_ergo ## Warning in geom_signif(data = annotation_df, aes(xmin = start, xmax = end, : ## Ignoring unknown aesthetics: xmin, xmax, annotations, and y_position plot_ergo "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
